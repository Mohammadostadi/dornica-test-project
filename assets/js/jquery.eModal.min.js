/*!
 * jQuery eModal Plugin
 * https://github.com/Reload-Lab/jquery-eModal
 *
 * @updated September 22, 2023
 * @version 2.1.2
 *
 * @author Domenico Gigante <domenico.gigante@reloadlab.it>
 * @copyright (c) 2023 Reload Laboratorio Multimediale <info@reloadlab.it> (https://www.reloadlab.it)
 * @license MIT
 */
!function(e){if(e.eModal)throw new Error("$.eModal already exists!");e.extend(e,{eModal:function(){var t,a,o,n={},i={},r="<div>",l="<button>",s='<h5>Loading...</h5><div class=progress><div class="progress-bar progress-bar-striped progress-bar-animated" style="width: 100%"></div></div>',d="",m="hide",p="click",c="submit",f="show.bs.modal",u="shown.bs.modal",b=m+".bs.modal",h="hidden.bs.modal",y="eModal",g="eStyle",x="modal-body",v=".modal-dialog",j=".modal-backdrop",w=".modal-content",C="eRecyclebin",k="modal-rec",H="modal-tmp",M="fade",T="btn-danger",O="input[type=text], input[type=password], input[type=email], input[type=tel], input[type=date], input[type=time], input[type=datetime-local], input[type=url], input[type=number], input[type=search], input[type=color], textarea, select",z={OK:"Cancel"},S={sm:"sm",lg:"lg",xl:"xl"},I=["modal-dialog","modal-eModal","modal-dialog-scrollable"],L={left:"start",center:"center",right:"end"},B={top:"start",middle:"center",bottom:"end"},E={animation:M,async:!1,ajax:{dataType:!1,error:!1,loading:!1,loadingHtml:s,success:!1,url:!1,xhr:{}},binId:!1,bodyStyles:!1,buttons:null,confirm:{label:Object.keys(z)[0],style:[]},cssClass:!1,footer:!0,header:!0,headerClose:!0,headerCloseHtml:'<button type="button" class="x close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>',height:!1,id:!1,iframe:{attributes:{},loadingHtml:s,url:!1},message:!1,modalOptions:!1,overlayClose:!0,onHide:!1,position:["top","center"],prompt:{autocomplete:!1,autofocus:!1,checkValidity:!1,label:Object.keys(z)[0],pattern:!1,placeholder:!1,required:!0,style:[],type:"text",value:!1},size:d,subtitle:!1,title:"Attention",useBin:!1,width:!1,wrapSubtitle:"<small>",wrapTitle:"<h5>"},F={alert:function(t,a){var o={message:t.message||t};return R(o=e.extend({},"object"==typeof t?t:{},o),a)},ajax:function(o,n){var r={ajax:{loading:!o.ajax||null==o.ajax.loading||o.ajax.loading,url:o.ajax&&o.ajax.url||o.message||o,xhr:{dataType:o.ajax&&o.ajax.dataType||"html",xhrFields:{withCredentials:!1}}}};return r=e.extend(!0,{},"object"==typeof o?o:{},r),e.ajax(r.ajax.url,r.ajax.xhr).done((function(o){if((e("#"+y).data("bs.modal")||{})._isShown)return t.find("."+x).html(r.ajax&&"function"==typeof r.ajax.success?r.ajax.success(o):o),!(!a||!i.async)&&a.resolve(t);t.on(u,(function(e){return t.find("."+x).html(r.ajax&&"function"==typeof r.ajax.success?r.ajax.success(o):o),!(!a||!i.async)&&a.resolve(t)}))})).fail((function(o,n,l){if((e("#"+y).data("bs.modal")||{})._isShown){var s=r.ajax&&"function"==typeof r.ajax.error?r.ajax.error(o,n,r):'<div class="alert alert-danger mb-0"><strong>XHR Fail: </strong>URL [ '+r.ajax.url+"] load fail.</div>";return t.find("."+x).html(s),!(!a||!i.async)&&a.reject(o)}t.on(u,(function(e){var l=r.ajax&&"function"==typeof r.ajax.error?r.ajax.error(o,n,r):'<div class="alert alert-danger mb-0"><strong>XHR Fail: </strong>URL [ '+r.ajax.url+"] load fail.</div>";return t.find("."+x).html(l),!(!a||!i.async)&&a.reject(o)}))})),R(r,n)},confirm:function(n,i){var r={async:!0,footer:!0,message:n.message||n,buttons:[{close:!0,click:l,resolve:!0,text:n.confirm&&z[n.confirm.label]?n.confirm.label:E.confirm.label,style:n.confirm&&n.confirm.style&&n.confirm.style[0]},{close:!0,text:n.confirm&&z[n.confirm.label]?z[n.confirm.label]:z[E.confirm.label],style:n.confirm&&n.confirm.style&&n.confirm.style[1]||T}]};return r=e.extend({},"object"==typeof n?n:{},r),o=l,R(r,i);function l(n){return o=null,e(n.currentTarget).data("resolve")?a.resolve(t):a.reject(t)}},prompt:function(n,i){var r={async:!0,footer:!1,message:n.message||n},l=V({footer:!0,buttons:[{close:!1,type:c,text:n.prompt&&z[n.prompt.label]?n.prompt.label:E.prompt.label,style:n.prompt&&n.prompt.style&&n.prompt.style[0]},{close:!0,type:"reset",text:n.prompt&&z[n.prompt.label]?z[n.prompt.label]:z[E.prompt.label],style:n.prompt&&n.prompt.style&&n.prompt.style[1]||T}]});return(r=e.extend({},"object"==typeof n?n:{},r)).message=e('<form class="m-0 p-0" role="form"><div class="'+x+'"><label for="prompt-input" class="control-label">'+(r.message||d)+'</label><input class="prompt-input form-control" type="'+(r.prompt&&r.prompt.type||"text")+'" value="'+(r.prompt&&r.prompt.value||d)+'"'+(r.prompt&&r.prompt.required?" required":d)+(r.prompt&&r.prompt.pattern?' pattern="'+r.prompt.pattern+'"':d)+' autocomplete="'+(r.prompt&&r.prompt.autocomplete?"on":"off")+'"'+(r.prompt&&r.prompt.placeholder?' placeholder="'+r.prompt.placeholder+'"':d)+'"></div></form>').append(l).on(c,(function(e){e.preventDefault();var o=t.find(".prompt-input").val();return e.type===c&&a.resolve(o),t.modal(m)})),o=function(){return o=null,!!a.promise&&a.reject(t)},R(r,i)},iframe:function(o,n){var r={footer:!1,iframe:{url:o.iframe&&o.iframe.url||o.message||o}};(r=e.extend(!0,{},"object"==typeof o?o:{},r)).message=e('<div class="'+x+' p-0"><div class="eLoading d-flex flex-column justify-content-center position-absolute w-100 h-100 p-3 text-center bg-white" style="z-index: 100"></div><iframe class="d-block w-100 h-100" frameborder="0" style="z-index: 10"></iframe></div>');var l=r.message.find("iframe").attr("src",r.iframe.url);return r.iframe&&"object"==typeof r.iframe.attributes&&e.each(r.iframe.attributes,(function(t,a){"width"!=t&&"height"!=t&&l.attr(t,e("<div/>").text(a).html())})),r.message.find(".eLoading").append(o.iframe&&o.iframe.loadingHtml||E.iframe.loadingHtml),P("3.0.0")?r.message.find("iframe").on("load",s):r.message.find("iframe").load(s),R(r,n);function s(){e(this).parents("."+x).find(".eLoading").fadeOut(400,(function(){e(this).remove()})),a.promise&&i.async&&a.resolve(t)}},embed:function(o,n){var r={iframe:{url:o.iframe&&o.iframe.url||o.message||o}};(r=e.extend(!0,{},"object"==typeof o?o:{},r)).message=e('<div class="'+x+' p-0"><div class="eLoading d-flex flex-column justify-content-center position-absolute w-100 h-100 p-3 text-center bg-white" style="z-index: 100"></div><div class="embed-responsive embed-responsive-16by9" style="z-index: 10"><iframe class="embed-responsive-item d-block w-100" frameborder="0"></iframe></div></div>');var l=r.message.find("iframe").attr("src",r.iframe.url);return r.iframe&&"object"==typeof r.iframe.attributes&&e.each(r.iframe.attributes,(function(t,a){"width"!=t&&"height"!=t&&l.attr(t,e("<div/>").text(a).html())})),r.message.find(".eLoading").append(o.iframe&&o.iframe.loadingHtml||E.iframe.loadingHtml),P("3.0.0")?r.message.find("iframe").on("load",s):r.message.find("iframe").load(s),R(r,n);function s(){e(this).parents("."+x).find(".eLoading").fadeOut(400,(function(){e(this).remove()})),a.promise&&i.async&&a.resolve(t)}}};return F.close=Q,F.label=function(e,t){return z[e]=t,F},F.emptyBin=function(){return e("#"+C+" > *").remove(),F},F.modal=function(){if(t)return t},F.defer=function(){if(a.promise)return a},F.size=function(e){return S[e]=e,F},F.version="2.1.2",F;function R(l,s){var d,m;return d="object"==typeof l?l:{},i={},e.extend(!0,i,E,d),console.log(i),function(t){n={},"object"==typeof t&&e.extend(n,t)}(i.modalOptions),i.overlayClose||(n.backdrop="static"),"string"==typeof l&&(i.message=l),s&&""!=s&&(i.title=s),function(a){if(!a)throw new Error("First argument cannot be blank!");t&&(t.off(f).off(u).off(b).off(h).off(p,".x").removeClass(M).find(v).removeAttr("id").removeClass((function(e,t){return t.split(" ").map((function(e){if(-1==I.indexOf(e))return e})).join(" ")})).find(w).children().remove(),t.find("#"+g).empty(),e(j).length&&e(j).remove(),t.modal("dispose")),function(a){(t=e("#"+y).length?e("#"+y):e('<div id="'+y+'" class="modal eModal" tabindex="-1"><div class="'+I.join(" ")+'"><div class="modal-content"></div></div><style id="'+g+'"></style></div>').appendTo("body")).addClass(a.animation).find(v).prop("id",(function(){return a.id||void 0})).addClass(a.cssClass||null).addClass(a.size&&S[a.size]?"modal-"+a.size:null),t.find("#"+g).html(function(e){if(e.width)var t=q(e.width);if(e.height)var a=q(e.height,"height");return".modal-eModal {display: flex; align-items: "+(B[e.position[0]]?B[e.position[0]]:E.position[0])+"; justify-content: "+(L[e.position[1]]?L[e.position[1]]:E.position[1])+"; width: calc(100% - 1rem)!important; max-width: none; height: calc(100% - 1rem)!important;}.modal-eModal.modal-dialog-scrollable .modal-content {overflow: visible !important;}@media (min-width: 576px) {.modal-eModal {width: calc(100% - 3.5rem)!important; height: calc(100% - 3.5rem)!important;}}.modal-eModal .modal-content {max-width: 500px;}.modal-eModal.modal-sm .modal-content {max-width: 300px;}.modal-eModal.modal-lg .modal-content {max-width: 800px;}.modal-eModal.modal-xl .modal-content {max-width: 1140px;}"+(t?".modal-eModal .modal-content {max-width: "+t+" !important; width: 100%;}":"")+(a?".modal-eModal .modal-content {max-height: "+a+" !important; height: 100%;}":"")}(a)),t.on(h,(function(a){!function(a){if(t){if(e("#"+C).length||e(r).appendTo("body").prop("id",C).hide(),a instanceof e.Event)var o=i;else o=a;var n=t.find("."+k).removeClass(k).appendTo("#"+C);o.binId&&n.prop("id",o.binId+"-bin"),o.useBin&&o.binId||n.remove()}}(a)})).on(p,".x",(function(e){N(e)})),a.prompt&&a.prompt.autofocus&&t.on(u,(function(){e(this).find(O).first().focus()}))}(a),"function"==typeof o&&t.on(b,o),"function"==typeof a.onHide&&t.on(b,a.onHide)}(i),t&&((a=e.Deferred()).promise=a.promise(),a.promise.element=t.find(v)),m={header:A(i),footer:V(i),body:D(i)},t&&(t.find(w).append(m.header,m.body,m.footer),t.modal(n)),!l.header&&l.overlayClose&&t.find(w).append('<button class="x btn btn-sm btn-dark position-absolute" style="top: -10px; left: -10px; width: 20px; height: 20px; padding: 0; line-height: 1;" data-dismiss="modal" type="button">&times;</button>'),a.promise&&!i.async&&t.on(u,a.reject),a.promise}function q(e,t){var a=Number(window.getComputedStyle(document.documentElement).getPropertyValue("font-size").match(/\d+/)[0]);if(window.innerWidth>=576)var o=3.5;else o=1;if(t&&"height"==t)var n=window.innerHeight-o*a;else n=window.innerWidth-o*a;return-1!=(""+e).indexOf("px")?((e=+e.replace("px",""))>n&&(e=n),e+"px"):-1!=(""+e).indexOf("%")?(e=(e=+e.replace("%",""))>100?n:parseInt(n*e/100))+"px":isNaN(+e)?void 0:((e=+e)>n?e=n:0==e&&(e=300),e+"px")}function A(t){if(t.header){var a=e(r).addClass("modal-header").prop("id","eHeader");if(t.title){var o=e(t.wrapTitle).appendTo(a).addClass("modal-title").html(t.title);t.subtitle&&e(t.wrapSubtitle).appendTo(o).html(" "+t.subtitle)}return t.headerClose&&e(t.headerCloseHtml).appendTo(a),a}return d}function V(a){if(a.footer){if(!1===a.buttons)return d;var o=e(r).addClass("modal-footer").prop("id","eFooter");if(Array.isArray(a.buttons))for(var n=0;n<a.buttons.length;n++){var i=a.buttons[n],s=e(l).attr("type","button").addClass("btn "+(i.style||"btn-primary"));for(var m in i.style&&delete i.style,i)if(i.hasOwnProperty(m))switch(m){case"close":i[m]&&s.attr("data-dismiss","modal").addClass("x");break;case p:if("function"==typeof i.click){var c=i.click.bind(t.find(w));s.on("click",c)}break;case"resolve":s.data(m,i[m]);break;case"text":s.html(i[m]);break;default:s.attr(m,e("<div/>").text(i[m]).html())}o.append(s)}else"string"==typeof a.buttons?o.html(a.buttons):o.append('<button class="x btn btn-primary" data-dismiss="modal" type="button">Close</button>');return o}return d}function D(t){if(t.message&&t.message instanceof jQuery)var a=t.message.clone(!0);else a=t.message;try{if(t.useBin&&t.binId&&e("#"+C).find("#"+t.binId+"-bin").length){var o=e("#"+C).find("#"+t.binId+"-bin"),n=o.clone(!0);o.remove()}else n=e(t.ajax.loading?t.ajax.loadingHtml:a);if(!n.length)throw new Error("This is a string!");if(n.hasClass(x)||n.find("."+x).length)var i=n.addClass(t.useBin?k:H);else i=e(r).addClass(x).addClass(t.useBin?k:H).attr("style","word-wrap: break-word;").append(n)}catch(o){console.log(o),i=e(r).addClass(x).attr("style","word-wrap: break-word;").html(t.ajax.loading?t.ajax.loadingHtml:a)}return i.prop("id",t.binId||"eBody"),t.bodyStyles&&t.bodyStyles!==i.css&&i.css(t.bodyStyles),i}function N(a){a.preventDefault();var o=e(a.currentTarget);if(o.prop("type")!==c)return t.modal(m);try{obj.prompt&&obj.prompt.checkValidity&&o.closest("form")[0].checkValidity()&&Q()}catch(e){Q()}}function P(t){var a=e.fn.jquery.split("."),o=t.split("."),n=a[0],i=a[1],r=a[2],l=o[0],s=o[1],d=o[2];return!(l>n||l===n&&s>i||l===n&&s===i&&d>r)}function Q(){t&&t.off(b).modal(m)}}()})}(jQuery);